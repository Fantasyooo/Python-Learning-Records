# -*- coding: utf-8 -*-
# å¸¦å°æ•°ç‚¹æ­£æ•°çš„å­—ç¬¦ä¸²è½¬æ¢æˆæµ®ç‚¹æ•°çš„å‡½æ•°
from functools import reduce

def str2float(s):
    digits = {'0': 0, '1': 1, '2': 2, '3': 3, '4': 4, '5': 5, '6': 6, '7': 7, '8': 8, '9': 9, '.': -1}

    # æ­¤å‡½æ•°ç”¨æ¥è¿‡æ»¤æ‰è¾“å…¥å‚æ•°ä¸­çš„å°æ•°ç‚¹
    def fn(x, y):
        if (y == -1):
            return x
        else:
            return x * 10 + y

    # æ­¤å‡½æ•°ç”¨æ¥å°†è¾“å…¥çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•´æ•°å‹
    def char2num(c):
        return digits[c]

    result = reduce(fn, map(char2num, s))     # ğŸ‘ˆå°†è¾“å…¥çš„å­—ç¬¦ä¸²å‚æ•°è½¬åŒ–æˆä¸å¸¦å°æ•°ç‚¹çš„æ•´æ•°å‹
    flag = 1                                  # è¿™ä¸ªå˜é‡ç”¨æ¥ç¡®å®šå°æ•°ç‚¹çš„ä½ç½®

    # ğŸ‘‡é€šè¿‡ä¸‹é¢çš„å¾ªç¯æ‰¾åˆ°å°æ•°ç‚¹çš„ä½ç½®
    for i in range(len(s) - 1, 0, -1):
        if (s[i] == '.'):
            break                             # ä¸€æ—¦æ‰¾åˆ°å°æ•°ç‚¹ä½ç½®ï¼Œç«‹åˆ»ç»“æŸå¾ªç¯
        flag *= 10                            # è‹¥æ²¡æœ‰æ‰¾åˆ°å°æ•°ç‚¹ä½ç½®ï¼Œflagå˜é‡*10ï¼ˆå°†å°æ•°ç‚¹å·¦ç§»ä¸€ä½ï¼‰
    return result / flag                      # é€šè¿‡é™¤ä»¥flagå˜é‡å‘resultæ’å…¥å°æ•°ç‚¹

print(str2float('54.7807'))                   # æµ‹è¯•è¾“å‡ºç»“æœ
